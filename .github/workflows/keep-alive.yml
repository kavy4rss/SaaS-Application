name: Keep Neon Database Warm

on:
  schedule:
    # Runs every 4 minutes (Neon pauses inactive databases after 5 minutes)
    - cron: '*/4 * * * *'
  workflow_dispatch: # Allows manual triggering from GitHub UI

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping Keep-Alive Endpoint
        run: |
          curl -f -X GET \
            -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
            ${{ secrets.PRODUCTION_URL }}/api/cron/keep-alive
        
      - name: Report Status
        if: always()
        run: echo "Ping completed."
